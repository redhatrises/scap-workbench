os: osx
osx_image: xcode8.3
sudo: required

language: cpp

compiler:
  - gcc

before_install:
  - brew update
  - brew install cartr/qt4/qt@4
  - brew install asciidoctor

before_script:
  - git clone --depth 1 https://github.com/openscap/openscap.git -b master
  - pushd openscap/build
  - cmake ../
  - make -j 4
  - make install
  - popd

script:
  - ./build-for-osx.sh
  - wget https://github.com/OpenSCAP/scap-security-guide/releases/download/v0.1.31/scap-security-guide-0.1.31.zip -O ssg.zip
  - unzip ssg.zip -d `pwd`/scap-workbench.app/Contents/Resources/ssg/
  - ./osx-create-dmg.sh
